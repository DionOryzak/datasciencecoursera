policyTerm="12 Months"
occupantLessor="Occupant Tenant"
classDesc1="Contractor"
classDesc2="Lawn Sprinkler Installation"
classDesc3="Shop"
ratingTerritory=13
construction="Frame Construction"
ppc=5
sprinklered="Yes"
buildingCode="Ungraded"
buildingsLOI=400000
bppLOI=100000
liabExposure=50000
liabLimits='300k/600k/600k'
propertyDeductible=500
windDeductible=NA
amountOfAnnualIncrease=0.08

SELECT factor
FROM mu_ru_policyterm
WHERE termOfPolicy="12 Months"

SELECT a.classCode,	a.sicCode,	a.naicsCode, ,	a.propertyRateNumber, a.liabClassGroup,	a.liabExpBase,	a.eq, a.eqsl, b.bldgFactor, b.bppFactor, c.bldgFactor, c.bppFactor, d.factor, e.factor, f.factor
FROM mu_ru_classCode AS a
INNER JOIN mu_ru_ratenumberrelativities AS b
ON a.propertyRateNumber=b.propertyRateNumber
INNER JOIN mu_ru_sprinklered AS c
ON a.propertyRateNumber=c.propertyRateNumber
LEFT JOIN mu_ru_occupantliabilityclassgrouprelativitiesloi AS d
ON a.liabClassGroup=c.classGroup
LEFT JOIN mu_ru_occupantliabilityclassgrouprelativitiesags AS e
ON a.liabClassGroup=e.classGroup
LEFT JOIN mu_ru_occupantliabilityclassgrouprelativitiesap AS f
ON a.liabClassGroup=f.classGroup
WHERE a.classDesc1='Contractor' AND a.classDesc2='Lawn Sprinkler Installation' AND a.classDesc3='Shop'
AND (f.premise='' OR (a.classDesc3='Office' AND f.premise='office') OR (a.classDesc3='Shop' AND f.premise='shop_storage')

SELECT bldgFactor, bppFactor
FROM mu_ru_constructionrelativities
WHERE constructionType='Frame Construction'

SELECT buildingLossCostPer100,	bppLossCostPer100,	occupantLossCostPer100, occupantLossCostPer1000AGS,	occupantLossCostPer1000AP, lessorsLossCostPer100
FROM ca_lc_baselosscostspropertyandliability
WHERE territory=13

SELECT bldgFactor, bppFactor
FROM mu_ru_ppc
WHERE ppc=5

SELECT b.factor+(400000-b.buildingLimitFrom)/100000*b.marginalPer100000 AS factor
FROM `ca_ru_buildinglimitofinsurancerelativitygroup` AS a
INNER JOIN mu_ru_buildinglimitofinsurancerelativity AS b
ON a.buildinglimitofinsurancerelativitygroup=b.group
WHERE a.territory=13 AND buildingLimitFrom<=400000 AND (buildingLimitTo>400000 OR buildingLimitTo=0)

SELECT factor+(100000-bppLimitFrom)/100000*marginalPer100000 AS factor
FROM mu_ru_businesspersonalpropertylimitofinsurancerelativity
WHERE bppLimitFrom<=100000 AND (bppLimitTo>100000 OR bppLimitTo=0)

SELECT *
FROM mu_ru_increasedlimits
WHERE limit1= 300000 AND limit2=600000 AND limit3=900000

SELECT CASE WHEN windDeductible=NA THEN fixedDollarDeductibleFactor WHEN windDeductible=1percent THEN WindstormOrHailDeductible_1percent WHEN windDeductible=2percent THEN WindstormOrHailDeductible_2percent WHEN windDeductible=3percent  THEN WindstormOrHailDeductible_3percent END AS factor
FROM mu_ru_optionalpropertydeductible
WHERE fixedDollarDeductible=500 AND bldgAndBPPLOIFrom <= (400000+100000) AND bldgAndBPPLOITo>(400000+100000)

SELECT perOccurenceFactor
FROM mu_ru_propertydamageliabilitydeductible
WHEN deductible=500

SELECT factor
FROM mu_ru_automaticincreaseininsurance
WHERE amountofAnnualIncrease=0.08
