SELECT 
ROUND(bppRate*accountsreceivable.factor*:accountsReceivableLimit/100,0) AS accountsReceivableLossCost,
ROUND(IF(:buildingsACV='Yes',acvbuildings.factor*liabPremium,0),0) AS acvBuildingsLossCost,
ROUND(autoincrease.factor*(buildingsPremium+functionalBuildingsPremium),0) AS buildingsAnnualIncreaseLossCost,
ROUND(bppRate*biproperties.factor*:businessIncomeDependentPropertiesLimit/100,0) AS businessIncomeDependentPropertiesLossCost,
ROUND(autoincrease.factor*(buildingsPremium+functionalBuildingsPremium+bppPremium+functionalBppPremium),0) AS buildingsAnnualIncreaseLossCost,
ROUND(bipayrollperiod.factor*(buildingsPremium+functionalBuildingsPremium+bppPremium+functionalBppPremium),0) AS biPayrollLossCost,
ROUND(biextendedperiod.factor*(buildingsPremium+functionalBuildingsPremium+bppPremium+functionalBppPremium),0) AS biExtendedLossCost,
ROUND(bppRate*electronicdata.factor*:electronicDataLimit/100,0) AS electronicDataLossCost,
ROUND(firedepartmentservice.lossCost*:numLocations),0) AS fireDepartmentServiceLossCost,
ROUND(IF(:forgeryAlteration="Yes",forgeryalteration.factor*employeedishonesty.employeeDishonestyLossCost,0),0) AS forgeryAlterationLossCost,
ROUND(bppRate*interruptioncomputeroperations.factor*:interruptionComputerOperationsLimit/100,0) AS interruptionComputerOperationsLossCost,
ROUND(IF(:equipmentBreakdown='Yes',(equipmentbreakdownbaseloss.lossCost+equipmentbreakdownhighloi.factor*GREATEST(IF(:buildingsLOI=0,bppLimit,buildingsLOI)-600000,0)/100000)*equipmentbreakdowndeductible.factor*equipmentbreakdowntimedeductible.factor,0),0) AS equipmentBreakdownLossCost,
ROUND(onPremisesLossCostPer100*moneySecuritiesOnPremiseLimit/100,0) AS onPremisesMoneyLossCost
ROUND(offPremisesLossCostPer100*moneySecuritiesOffPremiseLimit/100,0) AS offPremisesMoneyLossCost
ROUND(outdoorsigns.factor*:outdoorSignsLimit,0) AS outdoorSignsLossCost
ROUND(valuablepapers.factor*:valuablePapersRecordsLimit,0) AS valuablePapersLossCost
ROUND(outdoorproperty.factor*:outdoorPropertyLimit,0) AS outdoorPropertyLossCost




LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Accounts Receivable') AS accountsreceivable
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Actual Cash Value Buildings Option') AS acvbuildings
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_automaticincreaseininsurance` WHERE amountOfAnnualIncrease=:buildingsAnnualLimitIncrease) AS autoincrease
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_bidependentproperties` WHERE biType=:businessIncomeDependentPropertiesType) AS biproperties
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_businessincomeextendedperiodofindemnity` WHERE numberOfDays=:businessIncomePayrollNumDays) AS bipayrollperiod
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_businessincomeordinarypayroll` WHERE numberOfDays=:businessIncomeExtendedNumDays) AS biextendedperiod
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Electronic Data') AS electronicdata
ON 1=1
LEFT JOIN (SELECT lossCost FROM `mu_lc_firedepartmentservicecharge` WHERE `limit`=:fireDepartmentLimit) AS firedepartmentservice
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Forgery Or Alteration') AS forgeryalteration
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Interruption Of Computer Operations') AS interruptioncomputeroperations
ON 1=1
LEFT JOIN (SELECT lossCost FROM `mu_lc_equipmentbreakdownprotectioncoverage` WHERE IF(:buildingsLOI=0,bppLimit,buildingsLOI)>=limitFrom AND (IF(:buildingsLOI=0,bppLimit,buildingsLOI)<limitTo OR limitTo=0)) AS equipmentbreakdownbaseloss
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Equipment Breakdown') AS equipmentbreakdownhighloi
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_optionalpropertydamagedeductible` WHERE `deductible`=:equipmentBreakdownDeductible) AS equipmentbreakdowndeductible
ON 1=1
LEFT JOIN (SELECT factor FROM `mu_ru_optionaltimedeductible` WHERE `hours`=:equipmentBreakdownTimeDeductible) AS equipmentbreakdowntimedeductible
ON 1=1
LEFT JOIN (
	SELECT onPremisesLossCostPer100, offPremisesLossCostPer100 FROM `ca_lc_moneyandsecurities` 
	WHERE territory=:territory AND CASE WHEN GREATEST(LOCATE('Apartment',CONCAT(:classDesc1,:classDesc2,:classDesc3)),LOCATE('Residential Condominium',CONCAT(:classDesc1,:classDesc2,:classDesc3))) >0   THEN 'Apartment & Apartment Condominiums' WHEN GREATEST(LOCATE('Office',CONCAT(:classDesc1,:classDesc2,:classDesc3)),LOCATE('Commercial Condominium',CONCAT(:classDesc1,:classDesc2,:classDesc3)))>0  THEN 'Office & Office Condominiums' ELSE 'All Other' END = classType
) AS moneysecurities
On 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Outdoor Signs (per $100)') AS outdoorsigns
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Valuable Papers And Records') AS valuablepapers
ON 1=1
LEFT JOIN (SELECT factor FROM `singleconditions` WHERE `condition`='Outdoor Property') AS outdoorproperty
ON 1=1
